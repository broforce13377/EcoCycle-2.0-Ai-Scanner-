<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoCycle AI Scanner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;800&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: #eef1f4; min-height: 100vh; display: flex; justify-content: center; align-items: center; }

        /* iPhone Frame */
        .iphone-frame { width: 400px; height: 850px; background: #000; border-radius: 55px; position: relative; box-shadow: 0 0 0 4px #333, 0 0 0 8px #000, 0 20px 50px rgba(0,0,0,0.4); padding: 12px; }
        .btn-side { position: absolute; background: #222; border-radius: 4px; width: 4px; }
        .power { right: -8px; top: 200px; height: 90px; }
        .vol-up { left: -8px; top: 180px; height: 55px; }
        .vol-down { left: -8px; top: 250px; height: 55px; }
        .action { left: -8px; top: 120px; height: 30px; }

        /* Screen */
        .screen { width: 100%; height: 100%; background: #fff; border-radius: 44px; overflow: hidden; position: relative; display: flex; flex-direction: column; }
        
        /* Status Bar */
        .status-bar { height: 50px; padding: 0 24px; display: flex; justify-content: space-between; align-items: center; position: absolute; top: 5px; width: 100%; z-index: 10; color: #000; font-weight: 600; font-size: 15px; }
        .dynamic-island { width: 120px; height: 36px; background: #000; border-radius: 20px; position: absolute; left: 50%; transform: translateX(-50%); top: 6px; display: flex; justify-content: flex-end; align-items: center; padding-right: 10px; }
        .camera { width: 12px; height: 12px; background: #111; border-radius: 50%; box-shadow: inset 0 0 3px #333; }
        .status-right { display: flex; gap: 6px; font-size: 13px; }

        /* Header */
        .header { height: 230px; background: linear-gradient(160deg, #5ec564 0%, #43a047 100%); border-bottom-left-radius: 45px; border-bottom-right-radius: 45px; padding-top: 55px; position: relative; color: white; text-align: center; box-shadow: 0 10px 25px rgba(76, 175, 80, 0.2); }
        .header-controls { display: flex; justify-content: space-between; padding: 0 25px; font-size: 20px; }
        .header-content { margin-top: 15px; }
        .logo-wrapper { display: inline-flex; padding: 8px; border: 2px solid rgba(255,255,255,0.8); border-radius: 50%; font-size: 20px; margin-bottom: 5px; }
        .app-name { display: block; font-size: 13px; font-weight: 500; opacity: 0.9; }
        .header h1 { font-size: 28px; font-weight: 700; text-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .header-bg-icon { position: absolute; right: 20px; bottom: 30px; font-size: 80px; opacity: 0.08; transform: rotate(-20deg); pointer-events: none;}

        /* Content */
        .content { flex: 1; display: flex; flex-direction: column; align-items: center; padding-top: 20px; }
        .info-text { text-align: center; font-size: 11px; color: #444; font-weight: 600; margin-bottom: 25px; line-height: 1.5; }

        /* Scanner */
        .scanner-area { width: 280px; height: 280px; border: 1px solid #eee; border-radius: 35px; position: relative; display: flex; justify-content: center; align-items: center; background: #fff; cursor: pointer; box-shadow: inset 0 0 20px rgba(0,0,0,0.01); margin-bottom: 25px; overflow: hidden; transition: transform 0.1s; }
        .scanner-area:active { transform: scale(0.98); }
        .scanner-glow { width: 140px; height: 140px; background: #4CAF50; border-radius: 50%; filter: blur(50px); opacity: 0.6; animation: breathe 3s infinite ease-in-out; }
        #scan-status { position: absolute; color: white; font-weight: 600; font-size: 16px; text-shadow: 0 1px 3px rgba(0,0,0,0.2); z-index: 2; }

        @keyframes breathe { 0%, 100% { transform: scale(1); opacity: 0.6; } 50% { transform: scale(1.3); opacity: 0.9; } }
        @keyframes rapidPulse { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(1.5); opacity: 0.5; } }

        /* Button */
        .action-btn { background: none; border: none; cursor: pointer; display: flex; flex-direction: column; align-items: center; gap: 8px; transition: transform 0.1s; }
        .action-btn:active { transform: scale(0.95); }
        .icon-circle { width: 60px; height: 60px; background: #dcede0; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; color: #2e7d32; box-shadow: 0 5px 15px rgba(76, 175, 80, 0.2); }
        .action-btn span { color: #4CAF50; font-weight: 600; font-size: 14px; }

        /* Result Card */
        .result-card { position: absolute; bottom: 100px; width: 85%; background: white; border-radius: 20px; padding: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); opacity: 0; transform: translateY(20px); transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1); pointer-events: none; }
        .result-card.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .result-card h3 { font-size: 15px; text-align: center; margin-bottom: 12px; color: #333; }
        .green-text { color: #2e7d32; font-weight: 700; }
        .result-row { display: flex; justify-content: space-between; align-items: center; font-size: 13px; margin-bottom: 6px; color: #555; }
        .dim { opacity: 0.4; }
        .status-dot { width: 10px; height: 10px; border-radius: 50%; }
        .status-dot.green { background: #00e676; box-shadow: 0 0 6px #00e676; }
        .status-dot.red { background: #ff5252; }

        /* Bottom Nav */
        .bottom-bar { height: 80px; border-top: 1px solid #f4f4f4; display: flex; justify-content: space-around; align-items: flex-start; padding-top: 15px; }
        .bottom-bar i { font-size: 22px; color: #aaa; cursor: pointer; transition: 0.2s; }
        .bottom-bar i:hover, .bottom-bar i.active-plus { color: #4CAF50; }
        .active-plus { transform: translateY(-4px); font-size: 24px !important; }
        .home-indicator { width: 130px; height: 5px; background: #000; opacity: 0.9; border-radius: 10px; position: absolute; bottom: 8px; left: 50%; transform: translateX(-50%); }
    </style>
</head>
<body>

    <div class="iphone-frame">
        <div class="btn-side power"></div>
        <div class="btn-side vol-up"></div>
        <div class="btn-side vol-down"></div>
        <div class="btn-side action"></div>

        <div class="screen">
            <div class="status-bar">
                <span class="time">9:41</span>
                <div class="dynamic-island"><div class="camera"></div></div>
                <div class="status-right"><i class="fas fa-signal"></i><i class="fas fa-wifi"></i><i class="fas fa-battery-full"></i></div>
            </div>

            <div class="header">
                <div class="header-controls">
                    <div class="left"><i class="fas fa-chevron-left"></i><i class="fas fa-cog"></i></div>
                    <div class="right"><i class="far fa-user-circle"></i><i class="far fa-bell"></i></div>
                </div>
                <div class="header-content">
                    <div class="logo-wrapper"><i class="fas fa-recycle"></i></div>
                    <span class="app-name">EcoCycle</span>
                    <h1>AI Scanner</h1>
                </div>
                <i class="fas fa-leaf header-bg-icon"></i>
            </div>

            <div class="content">
                <div class="info-text">
                    <p><i class="fas fa-volume-high"></i> "Scan Ready Sound Enabled"</p>
                    <p><i class="fas fa-volume-high"></i> "Beep on Successful Detection"</p>
                </div>

                <div class="scanner-area" onclick="handleScan()">
                    <div class="scanner-glow"></div>
                    <span id="scan-status">Scanning..</span>
                </div>

                <button class="action-btn" onclick="handleScan()">
                    <div class="icon-circle"><i class="fas fa-camera"></i></div>
                    <span>Scan Item</span>
                </button>

                <div class="result-card" id="result-card">
                    <h3>Scanned Item: <span class="green-text">Plastic Bottle</span></h3>
                    <div class="result-row">
                        <span>This item is recyclable</span><div class="status-dot green"></div>
                    </div>
                    <div class="result-row dim">
                        <span>This item is not recyclable</span><div class="status-dot red"></div>
                    </div>
                </div>
            </div>

            <div class="bottom-bar">
                <i class="fas fa-home"></i><i class="fas fa-map-marker-alt"></i><i class="fas fa-plus active-plus"></i><i class="fas fa-user-friends"></i><i class="fas fa-leaf"></i>
            </div>
            <div class="home-indicator"></div>
        </div>
    </div>

    <script>
        // Audio Context Variable (Initialized Lazily)
        let audioCtx = null;
        let scannerInterval = null;
        let hideResultTimeout = null;
        let isBusy = false;

        // 1. Initialize Audio SAFELY (Fixes Browser Blocking)
        function initAudio() {
            if (!audioCtx) {
                // Support for Safari/iOS and Chrome
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                audioCtx = new AudioContext();
            }
            // Always try to resume context if suspended
            if (audioCtx.state === 'suspended') {
                audioCtx.resume();
            }
        }

        // 2. Play Continuous "Blip"
        function playScannerBlip() {
            if (!audioCtx) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            osc.type = 'square';
            osc.frequency.setValueAtTime(1000, audioCtx.currentTime); // 1000Hz beep
            
            // Volume Envelope (Louder: 0.1)
            gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
            
            osc.start(audioCtx.currentTime);
            osc.stop(audioCtx.currentTime + 0.1);
        }

        // 3. Play Success Chime
        function playSuccessSound() {
            if (!audioCtx) return;
            const now = audioCtx.currentTime;
            playTone(880, 'sine', now, 0.1);
            playTone(1108, 'sine', now + 0.1, 0.2);
            playTone(1318, 'sine', now + 0.2, 0.4);
        }

        function playTone(freq, type, startTime, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            // Louder success sound (0.2)
            gain.gain.setValueAtTime(0, startTime);
            gain.gain.linearRampToValueAtTime(0.2, startTime + 0.02);
            gain.gain.exponentialRampToValueAtTime(0.001, startTime + duration);
            
            osc.start(startTime);
            osc.stop(startTime + duration);
        }

        // 4. Main Scan Handler
        function handleScan() {
            // STEP 1: Wake up Audio Engine (Must happen on click)
            initAudio();

            if (isBusy) return;
            isBusy = true;

            const glow = document.querySelector('.scanner-glow');
            const statusText = document.getElementById('scan-status');
            const resultCard = document.getElementById('result-card');

            // Clear old timer
            if (hideResultTimeout) {
                clearTimeout(hideResultTimeout);
                hideResultTimeout = null;
            }

            // Start Scanning UI
            resultCard.classList.remove('visible');
            statusText.innerText = "Scanning..";
            glow.style.animation = "rapidPulse 0.4s infinite alternate";

            // Start Audio Loop
            playScannerBlip();
            scannerInterval = setInterval(playScannerBlip, 400);

            // Wait 2.5s for result
            setTimeout(() => {
                clearInterval(scannerInterval);
                glow.style.animation = "breathe 3s infinite ease-in-out";
                statusText.innerText = "Complete!";
                
                playSuccessSound();
                resultCard.classList.add('visible');
                isBusy = false;

                // Auto-Hide after 5 seconds
                hideResultTimeout = setTimeout(() => {
                    resultCard.classList.remove('visible');
                }, 5000);

            }, 2500);
        }
    </script>
</body>
</html>